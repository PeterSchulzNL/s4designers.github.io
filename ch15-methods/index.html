<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>Page Title</title>
  <link rel="stylesheet" href="../css/main.css"/>
</head>
<body class="line-numbers">
  <aside id="toc-column"></aside>
  <aside id="agenda" include="../agenda.html"></aside>
  <div id="page">
    <main>

  <h1>chapter 15: active objects do it with <i>methods</i></h1>

  <p>Here's the code that the video starts out with: <download href="./methodsOnCanvas-v1.html"></download> You can use it whenever you feel like you don't understand everything in the code: pause the video, examine the code, experiment with it.</p>
  <youtube ytid="7-_LJDjyXSA"></youtube>

  <h3 class="assignment summary">15.1: summary and questions</h3>
  <section class="assignment">
    <answer  buttontext="mail your summary">15.1.a: Make a list with <i>3 to 5 bulletpoints</i> with the most important or interesting things in the video:</answer>
  </section>
  <section class="assignment">
      <answer noslider buttontext="mail your word list">15.1.b: Which words or concepts would you like us to explain during class?</answer>
  </section>

  <h3>15.2: your first method</h3>
  <section class="assignment">
  <h4>15.2.a: salut!</h4>
  <p>15.2Take this code, and give the object a method that calculates a proper salutation for the person:</p>
  <script type="text/plain" class="language-js">
    function createPerson( firstName, lastName, gender, title) {
      return { firstName: firstName, 
               lastName: lastName, 
               gender: gender, 
               title: title 
             }
    }

    var person1 = createPerson('Harry', 'Potter', 'male', null )  // null used to specify no title
    console.log( person1.sulutation() )  // => "Mr."
    var person2 = createPerson('Petunia', 'Dursley', 'female', null ) 
    console.log( person2.sulutation() )  // => "Mrs."
    var person3 = createPerson('Minerva', 'McGonagall', 'female', 'professor' )
    console.log( person3.sulutation() )  // => "professor"
    var person4 = createPerson('Tinky', 'Winky', 'other', null )
    console.log( person4.sulutation() )  // => "Mx."                // see https://en.wikipedia.org/wiki/Mx_(title)
  </script>
  <ul>
    <li>If the person has a title (title is not null or undefined), the title is the salutation</li>
    <li>Otherwise: "Mr." for male persons, "Mrs." for female persons, and "Mx." for people who are neither male or female.</li>
  </ul>
  <answer buttontext="mail your code"></answer>
  </section>
  
  <section class="assignment">
  <h4>15.2.b: 'nother method</h4>
  <p>Add to the same objects a method called <code>toString()</code>, that returns a string containing the salutation and the first name and last name. Also write some code to test the method.</p>
  <answer buttontext="mail your code"></answer>
  </section>

  <section class="assignment">
  <h4>15.2.c: toString() is special</h4>
  <p>Try this in the console:</p>
  <script type="text/plain" class="language-js">
    var person4 = createPerson('Tinky', 'Winky', 'other', null )
    alert( "I always watch " + person4 + " on television!")
  </script>
  <p>Can you think of a possible language rule that could explain the result?</p>
  <answer buttontext="mail your explanation"></answer>
  </section>

  <h3>15.3: new methods for old squares</h3>
  <section class="assignment">
  <h4>15.3.a: stop the show!</h4>
  <p>Download the final code for the moving squares from the video: <download href="./methodsOnCanvas-v2.html"></download></p>
  <ul>
    <li>Add a method to the square-objects that make them stop moving.</li>
    <li>Add a button to the HTML that stops both buttons by calling your method.</li>
  </ul> 
  <answer buttontext="mail your code"></answer>
  </section>

  <section class="assignment">
  <h4>15.3.b: </h4>
  <p>Replace the old function <code>startAnimation()</code>with the following code:</p>
  <script type="text/plain" class="language-js">
    function startAnimation() {
      setInterval( doAnimationStep, 40) // 40 ms = 25 frames per second
      // After the animation has started, a click on the canvas should 
      // be handled differently:
      canvasElement.onclick = handleCanvasClick
    }
    canvasElement.onclick = startAnimation
    
    function handleCanvasClick(eventInfo) {
      // Check if a square is hit by the nouse click.If so, call
      // a method on the square to respond to the click.
      // eventInfo.offsetX and eventInfo.offsetY give the canvas 
      // coordinates of the mouse click.

      if(squareOne.hitTest(eventInfo.offsetX, eventInfo.offsetY)) {
        squareOne.onclick()
      }
      if(squareTwo.hitTest(eventInfo.offsetX, eventInfo.offsetY)) {
        squareTwo.onclick()
      }
    }
    
    function hitTestSquare(mouseX,mouseY) {
      // test if mouse coordinates are inside the square
      var fitsHorizontally = mouseX >= this.x && mouseX < this.x+this.size
      var fitsVertically = mouseY >= this.y && mouseY < this.y+this.size
      return fitsHorizontally && fitsVertically
    } 
  </script>
  <p>This code allows the user to click inside the canvas, when the animation is running. Read the comments, and try to understand how it works.</p>
  <p>The code is missing two methods in the square-objects. That is your job:</p>
  <ul>
    <li>Determine what the names are for the methods that must exist in the square objects.</li>
    <li>We want each square to stop moving when it is clicked. The other one should keep moving (if it wasn't already stopped).</li>
    <li>Add the two methods. You probably won't have to write new functions for this, but if you feel that you do: that's fine, go ahead.</li>
  </ul>
  <answer buttontext="mail your code"></answer>
  </section>

  <h2>functions as values</h2>
  <youtube ytid="hVAMvad7Fh0"></youtube>

  <section class="assignment">
    <h3 class="assignment summary">15.4: questions?</h3>
    <answer noslider buttontext="mail your word list">15.4: Which words or concepts would you like us to explain during class?</answer>
  </section>

  <section class="assignment">
  <h3>15.5: warming up</h3>
  <script type="text/plain" class="language-js">
    function getElById(id) {
      return document.getElementById(id);
    }
  </script>
  <p>Rewrite this function as an anonymous function that is assigned to the variable <code>getElById</code>. The code should start with:</p>
  <script type="text/plain" class="language-js">
  var getElById = ___
  </script>
  <p>replace the ___ with your anonymous function.</p>
  <answer buttontext="mail your code"></answer>
  </section>

  <section class="assignment">
  <h3>15.6: anonymous event handlers</h3>
  <p>Create this HTML file:</p>
  <script type="text/plain" class="language-html">
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <title>Buttons</title>
    </head>
    <body>
      <h1 id="theHeader">The score is: 0</h1>
      <button id="add10000Button">add 10,000</button>
      <button id="add100Button">add 100</button>
      <button id="add1Button">add 1</button>
    
      <script>
    
        var theScore = 0
    
        function increaseScoreBy(amount) {
          theScore = theScore + amount
          document.getElementById("theHeader").innerHTML = "The score is: " + theScore
        }
    
        document.getElementById("add10000Button").onclick = ___

        document.getElementById("add100Button").onclick = ___

        document.getElementById("add1Button").onclick = ___

        
      &lt;/script>
    </body>
    </html>  
  
  </script>
  <p>Make sure that the buttons do as they say by adding event handling functions. Each event handler must be an anynymous functions that calls <code>increaseScoreBy(&hellip;)</code> with the appropriate argument.</p>
  <answer buttontext="mail your code"></answer>
  </section>

  <section class="assignment">
  <h3>15.7: anonymous timer</h3>
  <p>Start with the code you made in exercise 15.3 (or the code you can download there).</p>
  <p>Look for the place where the timer is started. Rewrite that code to use an anonymous function. The function name <code>doAnimationStep</code> should disappear from your program, but it's code should not.</p>
  <answer buttontext="mail your code"></answer>
  </section>

  <h2>polymorphism: objects do it their way</h2>
  <youtube ytid="coePwuUOySg"></youtube>
  <p>What are methods good for? It turns out that you can organize large programs very well by <b>hiding variation inside objects</b>. Take a game, for example: all the NPCs (non-player characters) can move, make sound, respond to the player etc. They all have to be able to do these things, but each kind of NPC should be allowed to do them differently from the other types of NPC. Using methods you can package this variation within the code for the NPC objects. The rest of the program only has to understand that it can <i>simply ask these objects</i> to move, play sound or respond. The rest of the game code doesn't have to have any code that deals with the differences between NPC types.</p>

  <h3 class="assignment summary">15.8: summary and questions</h3>
  <section class="assignment">
    <answer  buttontext="mail your summary">15.8.a: Make a list with <i>3 to 5 bulletpoints</i> with the most important or interesting things in the video:</answer>
  </section>
  <section class="assignment">
      <answer noslider buttontext="mail your word list">15.8.b: Which words or concepts would you like us to explain during class?</answer>
  </section>

  <h3>15.9: warming up</h3>
  <p>Here's a list of different types of animals, and a function:</p>
  <script type="text/plain" class="language-js">
    var animalFarm = [
      { name: "Bessie",
        type: "pig",
        toString: function() { return this.name + " the " + this.type }
      },
      { name: "Rufus",
        type: "dog",
        toString: function() { return this.name + " the " + this.type }
      },
      { name: "Angelina",
        type: "duck",
        toString: function() { return this.name + " the " + this.type }
      },
      { name: "Clarence",
        type: "pig",
        toString: function() { return this.name + " the " + this.type }
      },
      { name: "Ethel",
        type: "cat",
        toString: function() { return this.name + " the " + this.type }
      },
      { name: "Elmer",
        type: "pig",
        toString: function() { return this.name + " the " + this.type }
      },
      { name: "Florence",
        type: "dog",
        toString: function() { return this.name + " the " + this.type }
      },
    ]

    function animalMakeNoise(animal) {
      var theNoise;
      if( animal.type == "dog")       { theNoise = "Woof"  }
      else if( animal.type == "cat")  { theNoise = "Miauw" }
      else if( animal.type == "pig")  { theNoise = "Oink"  }
      else if( animal.type == "duck") { theNoise = "Quack" }
      else { theNoise == "????" }

      alert( animal.name + ' says "' + theNoise + '"')
      console.log( animal + ' says "' + theNoise + '"')
    }
  </script>

  <section class="assignment">
  <h4>15.8.a: cacophony</h4>
  <p>Add some code that make noise for every animal in the list. Your code should work with both short and long lists of dogs, cats, pigs and ducks.</p>
  <p>Compare the strings that are sent to the <code>alert()</code> command to the output on the console. Explain the output on the console.</p>
  <answer buttontext="mail your both the code, and your explanation"></answer>
  </section>
  
  <section class="assignment">
  <h4>15.8.b: method time</h4>
  <p>Give each animal a second method. The new method should do what the animalMakeNoise function does, but just for that animal object. Also, skip the <code>alert()</code>; it is OK to just output to the console.</p>
  <p>Adapt the code you wrote in the previous exercise to work with the method instead of the function.</p>
  <p>The result should be a program that does exactly the same thing (except for the alerts). This is called a <i>refactoring</i>. Refactorings should not change what the code does, but they are intended to make the program simpler. Do you think that this refactored code is more, or less complicated than the code before?</p>
  <answer buttontext="mail your both the code, and your opinion on the complexity"></answer>
  </section>


  <h3 style="font-weight: 400; text-align: center;">« the last exercises for this final section will be published soon »</h3>
</main>
  </div>
<script src='../js/chapters.js'></script>
</body>
</html>